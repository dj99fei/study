#存储管理

###虚拟地址和虚拟地址空间

内存中同时存在多个进程，每个进程的地址都是以0地址作为起始地址的虚拟地址空间，这个虚地址空间可以是线性的（一维的），也可以是多维的，这要取决于系统采用的存储管理方式。进程中的每一个指令和数据在这样的虚地址空间中都有一个惟一确定的地址，即虚拟地址。

每一个进程都具有各自独立的虚拟地址空间，而整个系统只有一个物理地址空间。任何一个要执行的进程，都必须进入真正的内存中，在内存的物理空间中存在，这就需要在虚拟地址空间和物理地址空间之间建立适当的映射关系。通过这种映射关系，逐部分地把存在于虚拟地址空间中的进程要执行的。

部分放在物理地址空间中，而其他暂时不执行的部分放在外部存储器中，内外存动态地传递数据，最终完成整个进程所执行的任务。这种映射，也称为地址变换，是操作系统在硬件的配合下实现的。

###内存管理方式

######页

把进程的虚拟地址空间划分为大小相等的部分，每一部分称为页（page），同时把物理内存空间也按照页的大小划分为小的部分，称为页面（page frame，也称为页架，页框）。对于80386体系，页和页面的大小都是4k字节。

在页和页面之间建立一一映射关系，连续的一维虚拟地址空间可以分别存放在不同的物理空间中，因此，物理存储中，每个页面内部地址连续，而页面之间的地址可以是连续的。页和页面之间的映射关系记录在一个表格中，这样的表格称为也表。每一个进程使用唯一的页表，页表的每一项数据称为页表项，表示虚拟空间中某一页和实际物理空间中某一页面的对应关系，页表也存储在物理空间内

![image](https://github.com/dj99fei/study/blob/master/os/images/169C5A42-7A63-4EF7-B5F7-397E16A44424.png?raw=true)

管理过程中，内外存的数据传递是以页为单位。

利用分页技术将一维连续虚拟空间划分为一个个页，进程的虚拟地址有两部分组成：页号P和页内地址（偏移地址）W。这两个部分的虚拟地址经过地址变换后，映射到物理内存的对应单元。具体变换过程如下图：

![image](https://github.com/dj99fei/study/blob/master/os/images/169C5A42-7A63-4EF7-B5F7-397E16A44424.png?raw=true)

